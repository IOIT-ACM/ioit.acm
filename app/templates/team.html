{% extends "base.html" %} {% block title %}Our Team - AISSMS IOIT ACM{% endblock %} {%
block og_title %}We are AISSMS IOIT ACM - Our Team{% endblock %} {% block
og_description %}Meet the passionate individuals behind AISSMS IOIT ACM. A team of
skilled members dedicated to innovating and building world-class applications
and experiences.{% endblock %} {% block og_image %}{{ url_for('static',
filename='img/team/team.jpeg') }}{% endblock %} {% block twitter_image %}{{
url_for('static', filename='img/team/team.jpeg') }}{% endblock %} {% block
twitter_title %}Our Team - AISSMS IOIT ACM{% endblock %} {% block twitter_description
%}Meet the AISSMS IOIT ACM team: a group of passionate individuals transforming novel
ideas into real-life applications. Join us in our journey to innovate.{%
endblock %} {% block content %}
<div
  class="relative h-auto md:mt-0 mt-20 md:h-[100vh] flex flex-col md:flex-row items-center justify-between bg-gray-100"
>
  <!-- Team Image -->
  <div class="w-full h-auto md:w-1/2 md:h-full px-4 md:px-0 parallax-scroll">
    <img
      src="{{ url_for('static', filename='img/team/team.jpeg') }}"
      alt="Team Header Image"
      class="object-cover bg-gray-300 h-full w-full rounded-br-[200px] md:rounded-br-[200px] rounded-tl-[200px] md:rounded-none border-2 border-blue-400 sm:border-none md:border-none"
    />
  </div>

  <!-- Text Content -->
  <div class="w-full md:w-1/2 text-left p-8 md:p-16 gsap-reveal">
    <h1 class="text-3xl md:text-5xl font-extrabold text-blue-600 mb-4">
      We are AISSMS IOIT ACM
    </h1>
    <p class="text-gray-700 mb-6 text-base md:text-lg">
      The brilliance of AISSMS IOIT ACM is made possible by the dedication of our team.
      Get to know the leaders and feel free to reach out to them!
    </p>
    <button
      onclick="scrollToTeam()"
      class="bg-blue-400 hover:bg-blue-500 text-gray-900 font-semibold px-8 py-3 rounded-lg shadow-md hover:no-underline backdrop-blur-sm flex gap-2 items-center mx-auto md:mx-0"
    >
      Meet our executives
      <i class="ml-2 fas fa-arrow-down"></i>
    </button>
  </div>
</div>

<div id="team-section" class="text-center py-16 px-4">
  <h2 id="domain-header" class="text-4xl font-bold text-blue-600 mb-6">
    Meet Our Team
  </h2>

  <!-- Dropdown for Year Selection -->
  <div class="mb-6">
    <label for="year-select" class="text-lg font-semibold">Select Year</label>
    <select id="year-select" class="p-2 rounded-md border border-gray-300">
      {% for year in years %}
      <option value="{{ year }}">{{ year }}</option>
      {% endfor %}
    </select>
  </div>

  <!-- Faculty Sponsor Centered -->
  <div class="flex justify-center mb-12">
    <div
      class="p-6 bg-white shadow-md rounded-lg hover:shadow-xl transition-shadow duration-300 w-full max-w-sm mx-auto"
      role="presentation"
    >
      <img
        src="/static/img/team/meenakshi-thalor.jpg"
        alt="Portrait of Dr. Meenakshi Thalor"
        class="w-full h-auto object-cover rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300"
      />
      <div class="text-center mt-4">
        <h3
          class="text-xl font-medium text-gray-800 hover:text-blue-600 transition-colors duration-200"
        >
          Dr. Meenakshi Thalor
        </h3>
        <p class="text-gray-500 text-base mt-1">Faculty Sponsor</p>
        <p class="text-gray-500 text-sm mt-1">
          Dean-International Partnership Cell, Faculty
          Sponsor-ACM Student Chapter at AISSMS Institute Of Information
          Technology
        </p>
        <div class="mt-3">
          <a
            href="https://www.linkedin.com/in/dr-meenakshi-thalor-03937840/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-600 hover:text-blue-400 transition duration-200 inline-flex gap-2 items-center"
          >
            <i class="fab fa-linkedin text-lg mr-1"></i>
            <span class="text-sm">Connect on LinkedIn</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <hr class="border-t-2 border-gray-500 my-8 max-w-3xl mx-auto" />

  <div id="team-selection" class="mb-10">
    <div class="flex flex-wrap justify-center gap-4" id="domain-buttons">
      <!-- Buttons will be added here by JavaScript -->
    </div>
  </div>

  <!-- Team Members Grid -->
  <div
    id="team-cards"
    class="grid grid-cols-2 md:grid-cols-3 gap-6 p-6 mx-auto max-w-7xl"
  ></div>
</div>

<div
  class="bg-gradient-to-r mt-20 from-blue-800 to-blue-600 py-8 px-6 text-center flex flex-col md:flex-row items-center justify-between text-white shadow-lg"
>
  <h2 class="text-2xl md:text-4xl font-bold mb-6 md:mb-0">
    Become a part of such awesomeness
  </h2>
  <a
    href="/join"
    class="bg-green-400 hover:bg-green-500 text-gray-900 font-semibold px-8 py-3 rounded-lg shadow-md transition-transform transform hover:scale-105 hover:no-underline"
  >
    Join AISSMS IOIT ACM
  </a>
</div>

<!-- Team Member Template -->
<template id="team-member-template">
  <div
    class="flex flex-col items-center text-blue-600 rounded-lg overflow-hidden gsap-reveal"
  >
    <!-- Image Section -->
    <div
      class="w-44 h-44 md:w-52 md:h-52 bg-gray-100 border border-gray-300 overflow-hidden rounded-full mb-4 shadow-lg"
    >
      <img
        src=""
        alt=""
        class="w-full h-full object-cover object-top transition-transform duration-300 hover:scale-110"
      />
    </div>
    <!-- Text Section -->
    <div class="p-4 text-center">
      <h3 class="text-lg font-semibold text-blue-800"></h3>
      <p class="text-sm text-gray-500 mb-3"></p>
      <div class="flex flex-row justify-center items-center gap-3"></div>
    </div>
  </div>
</template>

<script>
  const teamCardsContainer = document.getElementById("team-cards");
  const teamMemberTemplate = document.getElementById(
    "team-member-template",
  ).content;
  const domainButtonsContainer = document.getElementById("domain-buttons");
  const domainHeader = document.getElementById("domain-header");

  let selectedDomain = null;
  let teamDataCache = [];
  const domains = [
    { id: "core", text: "Core Team" },
    { id: "web", text: "Web Development Team" },
    { id: "documentation", text: "Documentation Team" },
    { id: "media", text: "Media Team" },
    { id: "tech", text: "Technical Team" },
    { id: "event-management", text: "Event Management Team" },
  ];

  const activeButtonClass =
    "px-6 py-2 rounded-full text-white bg-blue-500 border border-blue-600";
  const inactiveButtonClass =
    "px-6 py-2 rounded-full text-gray-600 bg-blue-50 border border-gray-300";

  domains.forEach((domain) => {
    const button = document.createElement("button");
    button.dataset.domain = domain.id;
    button.textContent = domain.id.charAt(0).toUpperCase() + domain.id.slice(1);
    button.className = `domain-btn ${inactiveButtonClass}`;

    button.addEventListener("click", () => toggleDomain(domain));
    domainButtonsContainer.appendChild(button);
  });

  function toggleDomain(domain) {
    const buttons = domainButtonsContainer.querySelectorAll(".domain-btn");

    if (selectedDomain === domain.id) {
      selectedDomain = null;
      buttons.forEach(
        (btn) => (btn.className = `domain-btn ${inactiveButtonClass}`),
      );
      domainHeader.textContent = "Meet Our Team";
    } else {
      selectedDomain = domain.id;
      buttons.forEach((btn) => {
        btn.className = `domain-btn ${btn.dataset.domain === domain.id ? activeButtonClass : inactiveButtonClass}`;
      });
      domainHeader.textContent = domain.text;
    }

    updateURLParams({ domain: selectedDomain });
    updateTeamCards(teamDataCache);
  }

  function updateURLParams(params) {
    const url = new URL(window.location);

    Object.keys(params).forEach((key) => {
      if (params[key]) {
        url.searchParams.set(key, params[key]);
      } else {
        url.searchParams.delete(key);
      }
    });

    window.history.pushState({}, "", url);
  }

  function getParamFromURL(paramName, fallback = null) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(paramName) || fallback;
  }

  function initializeDomainFromURL() {
    const domainFromURL = getParamFromURL("domain");
    if (domainFromURL) {
      const domain = domains.find((d) => d.id === domainFromURL);
      if (domain) {
        toggleDomain(domain);
      }
    }
  }

  function updateTeamCards(teamData) {
    teamCardsContainer.innerHTML = "";

    const filteredTeamData = selectedDomain
      ? teamData.filter((member) => member.domain === selectedDomain)
      : teamData;

    filteredTeamData.forEach((member) => {
      const clone = document.importNode(teamMemberTemplate, true);

      clone.querySelector("img").src = member.image;
      clone.querySelector("img").alt = member.name;
      clone.querySelector("h3").textContent = member.name;
      clone.querySelector("p").textContent = member.title;

      const socialLinksContainer = clone.querySelector("div.flex.flex-row");
      if (member.github)
        addSocialLink(
          socialLinksContainer,
          member.github,
          "fab fa-github",
          "text-gray-600",
        );
      if (member.linkedin)
        addSocialLink(
          socialLinksContainer,
          member.linkedin,
          "fab fa-linkedin",
          "text-blue-600",
        );
      if (member.instagram)
        addSocialLink(
          socialLinksContainer,
          member.instagram,
          "fab fa-instagram",
          "text-pink-600",
        );
      if (member.linktree)
        addSocialLink(
          socialLinksContainer,
          member.linktree,
          "fas fa-link",
          "text-green-600",
        );

      teamCardsContainer.appendChild(clone);
    });
  }

  function addSocialLink(container, url, iconClass, colorClass) {
    const link = document.createElement("a");
    link.href = url;
    link.target = "_blank";
    link.className = `${colorClass} transition duration-200`;
    link.innerHTML = `<i class="${iconClass} text-lg"></i>`;
    container.appendChild(link);
  }

  function fetchTeamData(year) {
    fetch(`/fetch-team?year=${year}`)
      .then((response) => {
        if (!response.ok) throw new Error("Year data not found");
        return response.json();
      })
      .then((teamData) => {
        teamDataCache = teamData;
        updateTeamCards(teamData);
      })
      .catch((error) => {
        console.error(error);
        teamCardsContainer.innerHTML =
          '<p class="text-red-500 md:col-span-3 text-center max-w-2xl mx-auto">Unable to load team data at the moment. Please try again later and ensure you have selected a valid year from the dropdown menu.</p>';
      });
  }

  function getYearFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    const year = urlParams.get("year");
    return year && !isNaN(year) ? year : "{{ latest_year }}";
  }

  document
    .getElementById("year-select")
    .addEventListener("change", function (e) {
      const selectedYear = e.target.value;

      const url = new URL(window.location);
      url.searchParams.set("year", selectedYear);
      window.history.pushState({}, "", url);

      fetchTeamData(selectedYear);
    });

  const initialYear = getYearFromURL();
  document.getElementById("year-select").value = initialYear;
  fetchTeamData(initialYear);
  initializeDomainFromURL();
</script>

<script>
  function scrollToTeam() {
    const target = document.getElementById("team-section");
    if (target) {
      target.scrollIntoView({ behavior: "smooth" });
    }
  }

  document.addEventListener("scroll", function () {
    const parallaxElements = document.querySelectorAll(".parallax-scroll");
    parallaxElements.forEach((element) => {
      let offset = window.scrollY * 0.2;
      element.style.transform = `translateY(-${offset}px)`;
    });
  });
</script>

{% endblock %}
